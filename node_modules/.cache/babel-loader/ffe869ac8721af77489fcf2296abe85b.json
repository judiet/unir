{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*!\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nvar utils_1 = require(\"../utils\");\n\nvar apollo_cache_inmemory_1 = require(\"apollo-cache-inmemory\");\n\nexports.defaultDataIdFromObject = apollo_cache_inmemory_1.defaultDataIdFromObject;\n\nvar deltaSync_1 = require(\"../deltaSync\");\n\nvar logger = utils_1.rootLogger.extend('offline-cache'); // Offline schema keys: Do not change in a non-backwards-compatible way\n\nexports.NORMALIZED_CACHE_KEY = 'appsync';\nexports.METADATA_KEY = 'appsync-metadata';\nvar WRITE_CACHE_ACTION = 'AAS_WRITE_CACHE';\n\nfunction isOfflineCacheOptions(obj) {\n  return !!obj.store;\n}\n\n;\n\nvar MyCache = function (_super) {\n  __extends(MyCache, _super);\n\n  function MyCache(optionsOrStore, config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    var _this = _super.call(this, config) || this;\n\n    if (isOfflineCacheOptions(optionsOrStore)) {\n      var store = optionsOrStore.store;\n      _this.store = store;\n    } else {\n      _this.store = optionsOrStore;\n    }\n\n    var cancelSubscription = _this.store.subscribe(function () {\n      var _a = _this.store.getState(),\n          _b = exports.NORMALIZED_CACHE_KEY,\n          _c = _a[_b],\n          normCache = _c === void 0 ? {} : _c,\n          _d = _a.rehydrated,\n          rehydrated = _d === void 0 ? false : _d;\n\n      _super.prototype.restore.call(_this, __assign({}, normCache));\n\n      if (rehydrated) {\n        logger('Rehydrated! Cancelling subscription.');\n        cancelSubscription();\n      }\n    });\n\n    return _this;\n  }\n\n  MyCache.prototype.restore = function (data) {\n    boundWriteCache(this.store, data);\n\n    _super.prototype.restore.call(this, data);\n\n    _super.prototype.broadcastWatches.call(this);\n\n    return this;\n  };\n\n  MyCache.prototype.write = function (write) {\n    _super.prototype.write.call(this, write);\n\n    if (write.dataId === 'ROOT_MUTATION') {\n      this.data.delete('ROOT_MUTATION');\n    }\n\n    if (this.data && typeof this.data.record === 'undefined') {\n      // do not persist contents of a RecordingCache\n      var data = _super.prototype.extract.call(this, true);\n\n      boundWriteCache(this.store, data);\n    } else {\n      logger('No dispatch for RecordingCache');\n    }\n  };\n\n  MyCache.prototype.reset = function () {\n    logger('Resetting cache');\n    boundWriteCache(this.store, {});\n    return _super.prototype.reset.call(this);\n  };\n\n  MyCache.prototype.getIdsMap = function () {\n    var _a = exports.METADATA_KEY,\n        idsMap = this.store.getState()[_a].idsMap;\n\n    return __assign({}, idsMap);\n  };\n\n  return MyCache;\n}(apollo_cache_inmemory_1.InMemoryCache);\n\nexports.default = MyCache;\n\nvar boundWriteCache = function boundWriteCache(store, data) {\n  logger(\"Dispatching \" + WRITE_CACHE_ACTION);\n  store.dispatch(writeThunk(WRITE_CACHE_ACTION, data));\n};\n\nvar writeThunk = function writeThunk(type, payload) {\n  return function (dispatch, _getState) {\n    return dispatch({\n      type: type,\n      payload: payload\n    });\n  };\n};\n\nexports.reducer = function () {\n  var _a;\n\n  return _a = {}, _a[exports.NORMALIZED_CACHE_KEY] = function (state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    var type = action.type,\n        normCache = action.payload;\n\n    switch (type) {\n      case WRITE_CACHE_ACTION:\n        return __assign({}, normCache);\n\n      default:\n        return state;\n    }\n  }, _a;\n};","map":{"version":3,"sources":["/home/julian/Dokumente/WhiteCloudContext/material-kit-react/node_modules/aws-appsync/lib/cache/offline-cache.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","defineProperty","exports","value","utils_1","require","apollo_cache_inmemory_1","defaultDataIdFromObject","deltaSync_1","logger","rootLogger","extend","NORMALIZED_CACHE_KEY","METADATA_KEY","WRITE_CACHE_ACTION","isOfflineCacheOptions","obj","store","MyCache","_super","optionsOrStore","config","_this","cancelSubscription","subscribe","_a","getState","_b","_c","normCache","_d","rehydrated","restore","data","boundWriteCache","broadcastWatches","write","dataId","delete","record","extract","reset","getIdsMap","idsMap","InMemoryCache","default","dispatch","writeThunk","type","payload","_getState","reducer","state","action"],"mappings":"AAAA;;AACA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,cAAa,GAAG,uBAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,cAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd;AAAiB,YAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAA1C;AAAwD,KAF9E;;AAGA,WAAOP,cAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,IAAAA,cAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASO,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBT,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,GAJD;AAKH,CAZ2C,EAA5C;;AAaA,IAAII,QAAQ,GAAI,QAAQ,KAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAAA,QAAQ,GAAGV,MAAM,CAACW,MAAP,IAAiB,UAASC,CAAT,EAAY;AACpC,SAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,WAAK,IAAIV,CAAT,IAAcS,CAAd;AAAiB,YAAIb,MAAM,CAACQ,SAAP,CAAiBH,cAAjB,CAAgCa,IAAhC,CAAqCL,CAArC,EAAwCT,CAAxC,CAAJ,EACbQ,CAAC,CAACR,CAAD,CAAD,GAAOS,CAAC,CAACT,CAAD,CAAR;AADJ;AAEH;;AACD,WAAOQ,CAAP;AACH,GAPD;;AAQA,SAAOF,QAAQ,CAACS,KAAT,CAAe,IAAf,EAAqBH,SAArB,CAAP;AACH,CAVD;;AAWAhB,MAAM,CAACoB,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACA;AACA;AACA;AACA;;AACA,IAAIC,OAAO,GAAGC,OAAO,CAAC,UAAD,CAArB;;AACA,IAAIC,uBAAuB,GAAGD,OAAO,CAAC,uBAAD,CAArC;;AACAH,OAAO,CAACK,uBAAR,GAAkCD,uBAAuB,CAACC,uBAA1D;;AACA,IAAIC,WAAW,GAAGH,OAAO,CAAC,cAAD,CAAzB;;AACA,IAAII,MAAM,GAAGL,OAAO,CAACM,UAAR,CAAmBC,MAAnB,CAA0B,eAA1B,CAAb,C,CACA;;AACAT,OAAO,CAACU,oBAAR,GAA+B,SAA/B;AACAV,OAAO,CAACW,YAAR,GAAuB,kBAAvB;AACA,IAAIC,kBAAkB,GAAG,iBAAzB;;AACA,SAASC,qBAAT,CAA+BC,GAA/B,EAAoC;AAChC,SAAO,CAAC,CAACA,GAAG,CAACC,KAAb;AACH;;AACD;;AACA,IAAIC,OAAO,GAAkB,UAAUC,MAAV,EAAkB;AAC3C1C,EAAAA,SAAS,CAACyC,OAAD,EAAUC,MAAV,CAAT;;AACA,WAASD,OAAT,CAAiBE,cAAjB,EAAiCC,MAAjC,EAAyC;AACrC,QAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AAAEA,MAAAA,MAAM,GAAG,EAAT;AAAc;;AACvC,QAAIC,KAAK,GAAGH,MAAM,CAACpB,IAAP,CAAY,IAAZ,EAAkBsB,MAAlB,KAA6B,IAAzC;;AACA,QAAIN,qBAAqB,CAACK,cAAD,CAAzB,EAA2C;AACvC,UAAIH,KAAK,GAAGG,cAAc,CAACH,KAA3B;AACAK,MAAAA,KAAK,CAACL,KAAN,GAAcA,KAAd;AACH,KAHD,MAIK;AACDK,MAAAA,KAAK,CAACL,KAAN,GAAcG,cAAd;AACH;;AACD,QAAIG,kBAAkB,GAAGD,KAAK,CAACL,KAAN,CAAYO,SAAZ,CAAsB,YAAY;AACvD,UAAIC,EAAE,GAAGH,KAAK,CAACL,KAAN,CAAYS,QAAZ,EAAT;AAAA,UAAiCC,EAAE,GAAGzB,OAAO,CAACU,oBAA9C;AAAA,UAAoEgB,EAAE,GAAGH,EAAE,CAACE,EAAD,CAA3E;AAAA,UAAiFE,SAAS,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAAlH;AAAA,UAAsHE,EAAE,GAAGL,EAAE,CAACM,UAA9H;AAAA,UAA0IA,UAAU,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAA/K;;AACAX,MAAAA,MAAM,CAAC9B,SAAP,CAAiB2C,OAAjB,CAAyBjC,IAAzB,CAA8BuB,KAA9B,EAAqC/B,QAAQ,CAAC,EAAD,EAAKsC,SAAL,CAA7C;;AACA,UAAIE,UAAJ,EAAgB;AACZtB,QAAAA,MAAM,CAAC,sCAAD,CAAN;AACAc,QAAAA,kBAAkB;AACrB;AACJ,KAPwB,CAAzB;;AAQA,WAAOD,KAAP;AACH;;AACDJ,EAAAA,OAAO,CAAC7B,SAAR,CAAkB2C,OAAlB,GAA4B,UAAUC,IAAV,EAAgB;AACxCC,IAAAA,eAAe,CAAC,KAAKjB,KAAN,EAAagB,IAAb,CAAf;;AACAd,IAAAA,MAAM,CAAC9B,SAAP,CAAiB2C,OAAjB,CAAyBjC,IAAzB,CAA8B,IAA9B,EAAoCkC,IAApC;;AACAd,IAAAA,MAAM,CAAC9B,SAAP,CAAiB8C,gBAAjB,CAAkCpC,IAAlC,CAAuC,IAAvC;;AACA,WAAO,IAAP;AACH,GALD;;AAMAmB,EAAAA,OAAO,CAAC7B,SAAR,CAAkB+C,KAAlB,GAA0B,UAAUA,KAAV,EAAiB;AACvCjB,IAAAA,MAAM,CAAC9B,SAAP,CAAiB+C,KAAjB,CAAuBrC,IAAvB,CAA4B,IAA5B,EAAkCqC,KAAlC;;AACA,QAAIA,KAAK,CAACC,MAAN,KAAiB,eAArB,EAAsC;AAClC,WAAKJ,IAAL,CAAUK,MAAV,CAAiB,eAAjB;AACH;;AACD,QAAI,KAAKL,IAAL,IAAa,OAAO,KAAKA,IAAL,CAAUM,MAAjB,KAA4B,WAA7C,EAA0D;AACtD;AACA,UAAIN,IAAI,GAAGd,MAAM,CAAC9B,SAAP,CAAiBmD,OAAjB,CAAyBzC,IAAzB,CAA8B,IAA9B,EAAoC,IAApC,CAAX;;AACAmC,MAAAA,eAAe,CAAC,KAAKjB,KAAN,EAAagB,IAAb,CAAf;AACH,KAJD,MAKK;AACDxB,MAAAA,MAAM,CAAC,gCAAD,CAAN;AACH;AACJ,GAbD;;AAcAS,EAAAA,OAAO,CAAC7B,SAAR,CAAkBoD,KAAlB,GAA0B,YAAY;AAClChC,IAAAA,MAAM,CAAC,iBAAD,CAAN;AACAyB,IAAAA,eAAe,CAAC,KAAKjB,KAAN,EAAa,EAAb,CAAf;AACA,WAAOE,MAAM,CAAC9B,SAAP,CAAiBoD,KAAjB,CAAuB1C,IAAvB,CAA4B,IAA5B,CAAP;AACH,GAJD;;AAKAmB,EAAAA,OAAO,CAAC7B,SAAR,CAAkBqD,SAAlB,GAA8B,YAAY;AACtC,QAAIjB,EAAE,GAAGvB,OAAO,CAACW,YAAjB;AAAA,QAA+B8B,MAAM,GAAG,KAAK1B,KAAL,CAAWS,QAAX,GAAsBD,EAAtB,EAA0BkB,MAAlE;;AACA,WAAOpD,QAAQ,CAAC,EAAD,EAAKoD,MAAL,CAAf;AACH,GAHD;;AAIA,SAAOzB,OAAP;AACH,CApD4B,CAoD3BZ,uBAAuB,CAACsC,aApDG,CAA7B;;AAqDA1C,OAAO,CAAC2C,OAAR,GAAkB3B,OAAlB;;AACA,IAAIgB,eAAe,GAAG,SAAlBA,eAAkB,CAAUjB,KAAV,EAAiBgB,IAAjB,EAAuB;AACzCxB,EAAAA,MAAM,CAAC,iBAAiBK,kBAAlB,CAAN;AACAG,EAAAA,KAAK,CAAC6B,QAAN,CAAeC,UAAU,CAACjC,kBAAD,EAAqBmB,IAArB,CAAzB;AACH,CAHD;;AAIA,IAAIc,UAAU,GAAG,SAAbA,UAAa,CAAUC,IAAV,EAAgBC,OAAhB,EAAyB;AAAE,SAAO,UAAUH,QAAV,EAAoBI,SAApB,EAA+B;AAAE,WAAOJ,QAAQ,CAAC;AAChGE,MAAAA,IAAI,EAAEA,IAD0F;AAEhGC,MAAAA,OAAO,EAAEA;AAFuF,KAAD,CAAf;AAG/E,GAHuC;AAGpC,CAHR;;AAIA/C,OAAO,CAACiD,OAAR,GAAkB,YAAY;AAC1B,MAAI1B,EAAJ;;AACA,SAAQA,EAAE,GAAG,EAAL,EACJA,EAAE,CAACvB,OAAO,CAACU,oBAAT,CAAF,GAAmC,UAAUwC,KAAV,EAAiBC,MAAjB,EAAyB;AACxD,QAAID,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,EAAR;AAAa;;AACrC,QAAIJ,IAAI,GAAGK,MAAM,CAACL,IAAlB;AAAA,QAAwBnB,SAAS,GAAGwB,MAAM,CAACJ,OAA3C;;AACA,YAAQD,IAAR;AACI,WAAKlC,kBAAL;AACI,eAAOvB,QAAQ,CAAC,EAAD,EAAKsC,SAAL,CAAf;;AACJ;AACI,eAAOuB,KAAP;AAJR;AAMH,GAVG,EAWJ3B,EAXJ;AAYH,CAdD","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/*!\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar utils_1 = require(\"../utils\");\nvar apollo_cache_inmemory_1 = require(\"apollo-cache-inmemory\");\nexports.defaultDataIdFromObject = apollo_cache_inmemory_1.defaultDataIdFromObject;\nvar deltaSync_1 = require(\"../deltaSync\");\nvar logger = utils_1.rootLogger.extend('offline-cache');\n// Offline schema keys: Do not change in a non-backwards-compatible way\nexports.NORMALIZED_CACHE_KEY = 'appsync';\nexports.METADATA_KEY = 'appsync-metadata';\nvar WRITE_CACHE_ACTION = 'AAS_WRITE_CACHE';\nfunction isOfflineCacheOptions(obj) {\n    return !!obj.store;\n}\n;\nvar MyCache = /** @class */ (function (_super) {\n    __extends(MyCache, _super);\n    function MyCache(optionsOrStore, config) {\n        if (config === void 0) { config = {}; }\n        var _this = _super.call(this, config) || this;\n        if (isOfflineCacheOptions(optionsOrStore)) {\n            var store = optionsOrStore.store;\n            _this.store = store;\n        }\n        else {\n            _this.store = optionsOrStore;\n        }\n        var cancelSubscription = _this.store.subscribe(function () {\n            var _a = _this.store.getState(), _b = exports.NORMALIZED_CACHE_KEY, _c = _a[_b], normCache = _c === void 0 ? {} : _c, _d = _a.rehydrated, rehydrated = _d === void 0 ? false : _d;\n            _super.prototype.restore.call(_this, __assign({}, normCache));\n            if (rehydrated) {\n                logger('Rehydrated! Cancelling subscription.');\n                cancelSubscription();\n            }\n        });\n        return _this;\n    }\n    MyCache.prototype.restore = function (data) {\n        boundWriteCache(this.store, data);\n        _super.prototype.restore.call(this, data);\n        _super.prototype.broadcastWatches.call(this);\n        return this;\n    };\n    MyCache.prototype.write = function (write) {\n        _super.prototype.write.call(this, write);\n        if (write.dataId === 'ROOT_MUTATION') {\n            this.data.delete('ROOT_MUTATION');\n        }\n        if (this.data && typeof this.data.record === 'undefined') {\n            // do not persist contents of a RecordingCache\n            var data = _super.prototype.extract.call(this, true);\n            boundWriteCache(this.store, data);\n        }\n        else {\n            logger('No dispatch for RecordingCache');\n        }\n    };\n    MyCache.prototype.reset = function () {\n        logger('Resetting cache');\n        boundWriteCache(this.store, {});\n        return _super.prototype.reset.call(this);\n    };\n    MyCache.prototype.getIdsMap = function () {\n        var _a = exports.METADATA_KEY, idsMap = this.store.getState()[_a].idsMap;\n        return __assign({}, idsMap);\n    };\n    return MyCache;\n}(apollo_cache_inmemory_1.InMemoryCache));\nexports.default = MyCache;\nvar boundWriteCache = function (store, data) {\n    logger(\"Dispatching \" + WRITE_CACHE_ACTION);\n    store.dispatch(writeThunk(WRITE_CACHE_ACTION, data));\n};\nvar writeThunk = function (type, payload) { return function (dispatch, _getState) { return dispatch({\n    type: type,\n    payload: payload,\n}); }; };\nexports.reducer = function () {\n    var _a;\n    return (_a = {},\n        _a[exports.NORMALIZED_CACHE_KEY] = function (state, action) {\n            if (state === void 0) { state = {}; }\n            var type = action.type, normCache = action.payload;\n            switch (type) {\n                case WRITE_CACHE_ACTION:\n                    return __assign({}, normCache);\n                default:\n                    return state;\n            }\n        },\n        _a);\n};\n"]},"metadata":{},"sourceType":"script"}